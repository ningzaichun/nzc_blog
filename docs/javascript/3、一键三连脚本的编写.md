# æˆ‘ä¸ºæ˜é‡‘ç¼–å†™äº†ä¸€æ¬¾ç®€æ˜“ç‰ˆä¸€é”®ä¸‰è¿çš„æ²¹çŒ´è„šæœ¬

> æ„Ÿè§‰åˆ›æ„å¤§èµ›çš„å¥–å“å¾ˆä¸°å¯Œï¼Œæƒ³è¦å¤šå†™å‡ ç¯‡ï¼Œå‘ç°æ˜¯çœŸçš„éš¾~
>
> è¿™æ¬¡çš„è¯ï¼Œå°è¯•ç€ç¼–å†™äº†ä¸€ä¸ªéå¸¸ç®€æ˜“çš„ä¸€é”®ä¸‰è¿çš„æ²¹çŒ´çš„è„šæœ¬æ–‡ä»¶ï¼Œå†…å®¹å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´ï¼Œåº”è¯¥ç®—æ˜¯å…¥é—¨çº§çš„å§~ï¼Œå¤§ä½¬ä»¬ï¼Œè½»å–·...

## å‰è¨€

>æˆ‘å¯¹äºæ²¹çŒ´æ’ä»¶ä¸€ç›´æ˜¯å¤„äºä¸€ç§éå¸¸å¥½å¥‡çš„çŠ¶æ€ï¼Œæ„Ÿè§‰åˆ«äººå†™å‡ºæ¥çš„æ’ä»¶éƒ½ç‰¹åˆ«ç‰¹åˆ«å‰å®³ï¼Œæœ€å…¸å‹çš„å°±æ˜¯è¯»ä¹¦çš„æ—¶å€™ï¼Œå†™ä¸ªæ’ä»¶ï¼Œè‡ªåŠ¨åˆ·å­¦ä¹ è§†é¢‘ç­‰ç­‰ï¼Œç½‘ä¸Šè¿˜æœ‰å»é™¤å¹¿å‘Šã€ç»Ÿè®¡ä¿¡æ¯ã€å¯¼å‡ºæ–‡æ¡£ã€ä¸‹è½½è§†é¢‘ç­‰ç­‰æ’ä»¶ï¼Œå¾ˆå¤šå¾ˆå¤šã€‚

ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡ï¼Œå°±è§‰å¾—å®ƒæ˜¯ä¸€ä»¶å­¦ä¹ æˆæœ¬éå¸¸é«˜çš„äº‹æƒ…ï¼Œåƒæ˜¯æ´ªæ°´çŒ›å…½ä¸€èˆ¬ï¼Œå¯¼è‡´ä¸€ç›´æ˜¯æç½®çš„çŠ¶æ€ï¼Œç„¶åè¿™æ¬¡æœ‰æ´»åŠ¨ï¼Œæˆ‘å°±æƒ³åˆ°äº†è¿™ä¸ªç‚¹ï¼Œå°±æƒ³è¦è¯•ä¸€è¯•ã€‚

æ¥è§¦ä¸‹æ¥åï¼Œå…¶å®å†™è¿™æ ·çš„è„šæœ¬æ–‡ä»¶ï¼Œè¿œæ²¡æœ‰æˆ‘æƒ³è±¡çš„é‚£ä¹ˆéš¾ï¼Œå¦‚æœæ˜¯å¯¹äºå‰ç«¯æ¥è¯´ï¼Œæ›´æ²¡æœ‰å•¥å­¦ä¹ æˆæœ¬ï¼Œå› ä¸ºå…¨éƒ¨éƒ½æ˜¯jsä»£ç ~

## ä¸€ã€å®ç°æ•ˆæœ

![ä¸€é”®ä¸‰è¿_](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a543085047c4f7e8491f0fc6f9c52f2~tplv-k3u1fbpfcp-zoom-1.image)

ç‚¹å‡»åˆ›å»ºå‡ºæ¥çš„ä¸€é”®ä¸‰è¿çš„æŒ‰é’®ï¼Œå°±å¯ä»¥å®ç°ç‚¹èµã€å…³æ³¨ã€è¯„è®ºï¼Œä¸‹æ¬¡çœ‹æ–‡ä¸è¿·è·¯~

å®ç°é€»è¾‘å€’æ˜¯éå¸¸ç®€å•ï¼Œä½†å› ä¸ºæˆ‘å¯¹äºå‰ç«¯æ²¡æœ‰é‚£ä¹ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥å…¶ä¸­çš„ä¸€äº›å‘ï¼Œæˆ‘éƒ½ç»™èººäº†ä¸€é~

## äºŒã€å®Œæ•´ä»£ç 

å°±æ˜¯å†™ç€ç©ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

```
 // ==UserScript==
 // @name          æ˜é‡‘ç‰Œä¸€é”®ä¸‰è¿
 // @namespace     https://juejin.cn/user/2859142558267559
 // @version       0.0.1
 // @description  æ‰“å¼€åšæ–‡ï¼Œç‚¹å‡»ä¸€é”®ç‚¹èµè¯„è®ºæŒ‰é’®åè‡ªåŠ¨ä¸ºè¯¥åšæ–‡ç‚¹èµæ”¶è—å…³æ³¨ï¼Œå‰ææ˜¯å·²ç»ç™»å½• æ˜é‡‘
 // @author       å®åœ¨æ˜¥
 // @include      *://juejin.cn/post/*
 // @include      *.juejin.cn/post/*
 // ==/UserScript==
 (function() {
     'use strict';
     var tag_list = document.createElement("div");
     tag_list.classList.add('tag-list'); // ç»™åˆ›å»ºå‡ºæ¥çš„div æ·»åŠ ä¸€ä¸ª class
     var button = document.createElement("button"); //åˆ›å»ºä¸€ä¸ªæŒ‰é’®
     button.textContent = "ä¸€é”®ä¸‰è¿"; //æŒ‰é’®å†…å®¹
     button.style.width = "90px"; //æŒ‰é’®å®½åº¦
     button.style.height = "32px"; //æŒ‰é’®é«˜åº¦
     button.style.align = "center"; //æ–‡æœ¬å±…ä¸­
     button.style.color = "white"; //æŒ‰é’®æ–‡å­—é¢œè‰²
     button.style.background = "#e33e33"; //æŒ‰é’®åº•è‰²
     button.style.border = "1px solid #e33e33"; //è¾¹æ¡†å±æ€§
     button.style.borderRadius = "4px"; //æŒ‰é’®å››ä¸ªè§’å¼§åº¦
     button.style.fontSize="14px";
     tag_list.appendChild(button);
 
     /**
     * ele: html å…ƒç´ 
     * className (string): è¦åˆ¤æ–­çš„ç±»å
     * è¿”å›å€¼: å…ƒç´ å«æœ‰è¯¥ç±»åè¿”å› true,ä¸åŒ…å«è¿”å› false
     */
     function hasClass (ele, className) {
         var reg = new RegExp('(^|\s)' + className + '(\s|$)')
         return reg.test(ele.className)
     }
 
     // ç‚¹èµ
     function clickLike(){
         var likeElement=document.getElementsByClassName("panel-btn")[0];
         if(!hasClass(likeElement,"active")){
             likeElement.click(); //ç‚¹èµ
         }
     }
     // å…³æ³¨
     function clickFollow(){
         var followElement=document.getElementsByClassName("follow-button")[0];
         if(!hasClass(followElement,"followed")){
             followElement.click(); //ç‚¹å‡»å…³æ³¨
         }
     }
     //è·å–ç„¦ç‚¹
     function getFocus() {
         document.getElementsByClassName('rich-input')[0].focus();
     };
     //æ‰“å¼€emoje è¡¨æƒ…é€‰æ‹©æ¡†
     function getEmojeClick() {
         document.getElementsByClassName("emoji-box")[0].click();
     }
     var items = [112,102,92,80,71,66,61,55,31,28];
     var randomNumber=items[Math.floor(Math.random() * items.length)];
     //é€‰æ‹©emojeè¡¨æƒ…
     function getChoseEmoje() {
         setTimeout(function(){
             var emojipicker = document.getElementsByClassName("emojipicker")[0];
             var emojeImage = emojipicker.getElementsByClassName("list")[1];
             var item = emojeImage.getElementsByClassName("item")[randomNumber];
             var img = item.getElementsByClassName("image")[0];
             img.click();
         },100);// setTimeout 0.1ç§’åæ‰§è¡Œ
     }
 
     //å‘è¡¨è¯„è®º
     function submitComment(){
         setTimeout(function(){
             document.getElementsByClassName("submit-btn")[0].click(); //å‘è¡¨è¯„è®º
         },100);// setTimeout 0.1ç§’åæ‰§è¡Œ
     }
 
     function clickBotton(){
         setTimeout(function(){
             //è°ƒç”¨ç‚¹èµæ–¹æ³•
             clickLike()
             //è°ƒç”¨å…³æ³¨æ–¹æ³•
             clickFollow()
             //è®©è¯„è®ºæ¡†è·å–ç„¦ç‚¹
             getFocus()
             //æ‰“å¼€emoje è¡¨æƒ…é€‰æ‹©æ¡†
             getEmojeClick()
             //é€‰æ‹©emojeè¡¨æƒ…
             getChoseEmoje()
             //å‘è¡¨è¯„è®º
             submitComment();
         },100);// setTimeout 0.1ç§’åæ‰§è¡Œ
     }
 
     // å»¶æ—¶å°†å…ƒç´ æ·»åŠ åˆ°é¡µé¢ä¸Šï¼Œæœ‰æ—¶å€™é¡µé¢åŠ è½½ç¼“æ…¢ï¼Œä¼šå¯¼è‡´ï¼Œè„šæœ¬æ‰§è¡Œå®Œï¼Œä½†é¡µé¢è¿˜åŠ è½½å®Œ~ï¼Œå¯¼è‡´å‡ºç°é”™è¯¯
     setTimeout(function(){
         var like_comment = document.getElementsByClassName('tag-list-box'); //getElementsByClassName è¿”å›çš„æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥è¦ç”¨[] ä¸‹æ ‡
         like_comment[0].appendChild(tag_list); //æŠŠæŒ‰é’®åŠ å…¥åˆ° x çš„å­èŠ‚ç‚¹ä¸­
     },500);
 
     button.addEventListener("click", clickBotton) //ç›‘å¬æŒ‰é’®ç‚¹å‡»äº‹ä»¶
 })(); //(function(){})() è¡¨ç¤ºè¯¥å‡½æ•°ç«‹å³æ‰§è¡Œ
 
```

```
 // ==UserScript==
 // @name          æ˜é‡‘ç‰Œä¸€é”®ä¸‰è¿
 // @namespace     https://juejin.cn/user/2859142558267559
 // @version       0.0.1
 // @description  æ‰“å¼€åšæ–‡ï¼Œç‚¹å‡»ä¸€é”®ç‚¹èµè¯„è®ºæŒ‰é’®åè‡ªåŠ¨ä¸ºè¯¥åšæ–‡ç‚¹èµæ”¶è—å…³æ³¨ï¼Œå‰ææ˜¯å·²ç»ç™»å½• æ˜é‡‘
 // @author       å®åœ¨æ˜¥
 // @include      *://juejin.cn/post/*
 // @include      *.juejin.cn/post/*
```

å…³äºè¿™äº› `@` çš„æ ‡è¯†ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥å»æœä¸€ä¸‹æ²¹çŒ´è„šæœ¬çš„å¼€å‘æ–‡æ¡£å³å¯ï¼Œå½“ç„¶è¿™å‡ ä¸ªä¹Ÿå¾ˆç®€å•ï¼Œå°±ä¸å¤šè¨€äº†ï¼Œå¦‚æœæ„Ÿå…´è¶£äº†ï¼Œå¯ä»¥å»æ‰¾ä¸€æ‰¾~

å°†è¿™ä¸ªè„šæœ¬æ·»åŠ åˆ°æ²¹çŒ´çš„è„šæœ¬ç®¡ç†é¡µé¢å³å¯ï¼š



![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/200d064652df404780f8824d5a94e5c4~tplv-k3u1fbpfcp-watermark.image?)
ï¼ˆå›¾ç‰‡è¯´æ˜ï¼šç‚¹å‡»æ·»åŠ æ–°è„šæœ¬ï¼‰


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3657a975743144eb8a34860e73bd2023~tplv-k3u1fbpfcp-watermark.image?)

ï¼ˆå›¾ç‰‡è¯´æ˜ï¼šæŠŠä¸Šé¢çš„ä»£ç ï¼Œç›´æ¥å¤åˆ¶ç²˜è´´è¿‡æ¥ï¼ŒCtrl+S ä¿å­˜å°±å¯ä»¥ç”Ÿæ•ˆäº†ï¼‰

## ä¸‰ã€è¸©å‘

è¸©å‘å…¨éƒ¨é›†ä¸­åœ¨æ·»åŠ è¯„è®ºé‚£ä¸€æ­¥ã€‚

æˆ‘åŸæœ¬çš„æƒ³æ³•æ˜¯

-   æ„å»ºå¥½ä¸€ä¸ªè¯„è®ºå†…å®¹çš„æ•°ç»„
-   æ¯æ¬¡ä¸€é”®ä¸‰è¿æ—¶ï¼Œä»ä¸­éšæœºæŠ½å–ä¸€æ¡è¯„è®º

ç„¶åè¸©å‘ä¹‹æ—…å°±å¼€å§‹å•¦~

æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ˜é‡‘çš„è¯„è®ºæ¡†åŒºåŸŸçš„ä»£ç ï¼š


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34b5186f8f4344118a0ef3f854f8bce2~tplv-k3u1fbpfcp-watermark.image?)

```
 <div data-v-013fc4fa="" data-v-7c7c7498="" class="input-box">
     <div  contenteditable="true"  spellcheck="false"        
         placeholder="è¾“å…¥è¯„è®ºï¼ˆEnteræ¢è¡Œï¼ŒCtrl + Enterå‘é€ï¼‰"                 
         disabled="disabled" class="rich-input   empty">
      </div>
 </div>
```

è¿™é‡Œçš„è¯ï¼Œå®ƒæ˜¯ç”¨ç”¨äº†ä¸€ä¸ª `contenteditable`æ¥åšä¸ºè¾“å…¥æ¡†çš„ã€‚

æˆ‘æ€»å…±æ˜¯é‡‡å–äº†ä¸‰ç§æ–¹å¼å»å°è¯•å®ç°~

### 3.1ã€ç›´æ¥æ”¹å˜ div çš„å†…å®¹

æˆ‘çš„æƒ³æ³•æ˜¯ï¼Œå…ˆè§¦å‘divçš„ç‚¹å‡»æ–¹æ³•ï¼Œç„¶åå°±ä¼šå‡ºç°å…‰æ ‡åœ¨è¾“å…¥æ¡†å†…ï¼Œè¿™æ ·å°±å¯ä»¥æ”¹å˜å…¶ä¸­å†…å®¹å•¦ã€‚

ç¬¬ä¸€æ¬¡å°±è¿™ä¹ˆå¼€å§‹å•¦~

```
             var comment=["é’ˆä¸æˆ³å‘€ï¼Œå†™çš„é’ˆä¸æˆ³ï¼","å­¦ä¹ äº†ï¼bï¼ˆï¿£â–½ï¿£ï¼‰d","æœ¬æ–‡ä¸é”™(ï¿£Ë‡ï¿£)ï¼Œå€¼å¾—å­¦ä¹ ï¼(=ï¿£Ï‰ï¿£=)","æ„Ÿè°¢åšä¸»çš„åˆ†äº«ï¼(^ ^)ï¼â–½â–½ï¼¼(^ ^)","æ„Ÿè°¢åšä¸»ï¼Œä½ çš„æ–‡ç« è®©æˆ‘å¾—åˆ°ä¸€äº›æ”¶è·ï¼(ï¿£Ë‡ï¿£)"];
             var STARTNUMBER = -1;
             var ENDNUMBER = 5;
             var temp_count = Math.floor(Math.random()*(STARTNUMBER-ENDNUMBER+1))+ENDNUMBER 
            
             document.getElementsByClassName("input-box")[0].click(); //æ‰“å¼€è¯„è®ºåŒº
             document.getElementsByClassName('rich-input')[0].classList.remove("empty");
             document.getElementsByClassName("rich-input")[0].innerHTML = comment[temp_count]; //éšæœºæŠŠä¸€æ¡é¢„å…ˆå†™å¥½çš„è¯„è®ºèµ‹å€¼åˆ°è¯„è®ºæ¡†é‡Œé¢
             document.getElementsByClassName("submit-btn")[0].click(); //å‘è¡¨è¯„è®º
```

ç»“æœï¼š


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92f089c3344a4ad2817c4f38ce4b129d~tplv-k3u1fbpfcp-watermark.image?)

å†…å®¹ä¸Šå»æ˜¯ä¸Šå»äº†ï¼Œä½†å®é™…ç‚¹å‡»æ–¹æ³•æ ¹æœ¬æ²¡æœ‰è¢«è§¦å‘ï¼Œè¿™åªèƒ½è¯´æ˜¯æ”¹å˜äº†divçš„å±•ç¤ºå†…å®¹ï¼Œè¿™å®Œå…¨æ²¡æœ‰ç‰µæ‰¯åˆ°å€¼çš„å˜åŒ–ï¼Œåœ¨è¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œæˆ‘åˆæ¥ç€è¿™ä¸ªæ€è·¯ï¼Œå°†åº•ä¸‹çš„æŒ‰é’®çš„ç¦ç”¨ç»™å»æ‰ï¼Œæ‰‹åŠ¨æäº¤äº†ä¸€éï¼ŒæŠ¥è¯„è®ºä¸ºç©ºçš„é”™è¯¯~

***

å’‹è¯´å‹’ï¼Œå¯¹è¿™ä¸ªæƒ³æ³•ä¸æ­»å¿ƒï¼Œæˆ‘ä»¥ä¸ºæ˜¯æˆ‘æ²¡æœ‰æˆåŠŸè§¦å‘ç‚¹å‡»æ–¹æ³•çš„é—®é¢˜ï¼Œæˆ‘åˆæ¥ç€å»æœç´¢æ€ä¹ˆè§¦å‘divçš„ç‚¹å‡»æ–¹æ³•ï¼Œæœäº†è›®å¤šçš„ï¼Œä½†æ˜¯éƒ½ä¸å¤ªå¯¹ã€‚

å…¶ä¸­è¿˜æœ‰å°è¯•äº†ä¸‹é¢çš„è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼š

```
 function emulateMouseClick (element) {
     // åˆ›å»ºäº‹ä»¶
     var event = document.createEvent('MouseEvents')
     // å®šä¹‰äº‹ä»¶ å‚æ•°ï¼š type, bubblesï¼šäº‹ä»¶å†’æ³¡, cancelable ï¼šæ˜¯å¦å¯æ’¤é”€
     event.initEvent('click', true, true)
     // è§¦å‘å¯¹è±¡å¯ä»¥æ˜¯ä»»ä½•å…ƒç´ æˆ–å…¶ä»–äº‹ä»¶ç›®æ ‡
     element.dispatchEvent(event)
 }
```

å‚è€ƒé“¾æ¥ï¼š

[MDN Document.createEvent()](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/createEvent) [åˆ›å»ºå’Œè§¦å‘äº‹ä»¶ï¼ˆen-US)](https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events)

***

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘åˆæƒ³åˆ°äº† div èº«ä¸Šçš„ `contenteditable="true"` å±æ€§ï¼Œå¯¹è¿™ä¸ªå±æ€§æœ‰ç‚¹é™Œç”Ÿï¼Œæ„Ÿè§‰å®ƒåº”è¯¥å¯¹æˆ‘æœ‰ç‚¹å¸®åŠ©ï¼Œç„¶åå°±æœåˆ°äº†ä¸‹é¢çš„å†…å®¹ï¼š


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/063f667424b14f9eb0d6a79585899a72~tplv-k3u1fbpfcp-watermark.image?)

ï¼ˆå›¾ç‰‡è¯´æ˜ï¼š[é“¾æ¥](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/contenteditable)ï¼‰

çœ‹åˆ°å¯ç¼–è¾‘ä¹‹åè¿™å‡ ä¸ªå­—åï¼Œæˆ‘åˆå¾€è¿™ä¸ªæ–¹å‘ç»§ç»­å»æ¢ç´¢~

åˆç»§ç»­æœåˆ°ä»¥ä¸‹çš„å†…å®¹ï¼š

[å¦‚ä½•è®©divè·å–ç„¦ç‚¹æˆ–å¯ç¼–è¾‘](https://www.cnblogs.com/wzihan/p/16204186.html)

[contenteditableè”åˆv-htmlå®ç°æ•°æ®åŒå‘ç»‘å®šçš„vueç»„ä»¶](https://www.cnblogs.com/dreamsqin/p/11466197.html)

[è®©divè·å–ç„¦ç‚¹](https://blog.csdn.net/weixin_44713688/article/details/120724061)

[Vueå®ç°å¯ç¼–è¾‘divè·å–ç„¦ç‚¹ğŸ‰](https://juejin.cn/post/6844904055647518727#heading-2)

æ‰¾ç€æ‰¾ç€ï¼Œæˆ‘å°±å»æ‰¾å¦‚ä½•è®©divè§¦å‘ç„¦ç‚¹äº‹ä»¶äº†ï¼Œå°±åˆæœ‰äº†ä¸‹é¢çš„å°è¯•

### 3.2ã€å°è¯•è®©divè·å–ç„¦ç‚¹

åœ¨è¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œç‡å…ˆå°è¯•çš„æ˜¯ä¸‹é¢çš„è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºè¿™ä½ä½œè€…å°è¯•ç”¨Vueå»å®ç°æ˜é‡‘å‘é€æ²¸ç‚¹çš„é‚£ä¸ªé€‰æ‹©è¡¨æƒ…çš„åŠŸèƒ½ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿè®©é¿å…äº†ä¸€äº›å‘~

[Vueå®ç°å¯ç¼–è¾‘divè·å–ç„¦ç‚¹ğŸ‰](https://juejin.cn/post/6844904055647518727#heading-2) æ„Ÿè°¢ä½œè€…~

è¿™ç¯‡æ–‡ç« ç”¨äº†


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2bf1022d13f9493495af65c520c872e6~tplv-k3u1fbpfcp-watermark.image?)

ä»¥ä¸Šä¸‰ç§æ–¹å¼æ¥å°è¯•å®ç°ï¼Œç¬¬ä¸€ä¸ª `tabindex=0`ï¼Œå¥½åƒæ˜¯ä¸è¡Œçš„ï¼Œæˆ‘å°±ç›´æ¥è·³è¿‡äº†ã€‚

æˆ‘åˆæ¥ç€å»æ‰¾å¯»ç¬¬äºŒç§æ–¹å¼ï¼š

å‘ç°ä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š

[åœ¨å¯ç¼–è¾‘divä¸­å®šä½å…‰æ ‡å’Œè®¾ç½®å…‰æ ‡](https://blog.csdn.net/weixin_40629244/article/details/104642683)ï¼Œè¿˜ç»™äº†ä»£ç å’Œå®ä¾‹


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/457aa75062b149588c8c08cfc90dbe40~tplv-k3u1fbpfcp-watermark.image?)

ä½œè€…çš„æºä»£ç ï¼Œå¤§å®¶å¯ä»¥ç‚¹é“¾æ¥è¿‡å»çœ‹ä¸€ä¸‹ï¼Œæˆ‘å°±ä¸å¢åŠ ç¯‡å¹…äº†ã€‚

å‚è€ƒå®Œä¸Šé¢ä½œè€…çš„ä»£ç ï¼Œæˆ‘æ”¹æˆäº†ä¸‹é¢è¿™æ ·ï¼š

```
 // å®šä¹‰æœ€åå…‰æ ‡å¯¹è±¡
 var lastEditRange;
 // ç¼–è¾‘æ¡†ç‚¹å‡»äº‹ä»¶
 document.getElementsByClassName("rich-input")[0].onclick = function () {
     // è·å–é€‰å®šå¯¹è±¡
     var selection = getSelection();
     // è®¾ç½®æœ€åå…‰æ ‡å¯¹è±¡
     lastEditRange = selection.getRangeAt(0);
 };
 // ç¼–è¾‘æ¡†æŒ‰é”®å¼¹èµ·äº‹ä»¶
 document.getElementsByClassName("rich-input")[0].onkeyup = function () {
     // è·å–é€‰å®šå¯¹è±¡
     var selection = getSelection();
     // è®¾ç½®æœ€åå…‰æ ‡å¯¹è±¡
     lastEditRange = selection.getRangeAt(0);
 };
 
 // å‘é€è¡¨æƒ…
 function editContent() {
     // è·å–å¯ç¼–è¾‘æ¡†
     var editor = document.getElementsByClassName("rich-input")[0];
     // è·å–è¾“å…¥æ¡†
     var comment = [
         "é’ˆä¸æˆ³å‘€ï¼Œå†™çš„é’ˆä¸æˆ³ï¼",
         "å­¦ä¹ äº†ï¼bï¼ˆï¿£â–½ï¿£ï¼‰d",
         "æœ¬æ–‡ä¸é”™(ï¿£Ë‡ï¿£)ï¼Œå€¼å¾—å­¦ä¹ ï¼(=ï¿£Ï‰ï¿£=)",
         "æ„Ÿè°¢åšä¸»çš„åˆ†äº«ï¼(^ ^)ï¼â–½â–½ï¼¼(^ ^)",
         "æ„Ÿè°¢åšä¸»ï¼Œä½ çš„æ–‡ç« è®©æˆ‘å¾—åˆ°ä¸€äº›æ”¶è·ï¼(ï¿£Ë‡ï¿£)",
     ];
     var STARTNUMBER = -1;
     var ENDNUMBER = 5;
     var temp_count =
         Math.floor(Math.random() * (STARTNUMBER - ENDNUMBER + 1)) + ENDNUMBER; //å–STARTNUMBER-ENDNUMBERä¹‹é—´çš„éšæœºæ•° [STARTNUMBER,ENDNUMBER]
     var editComment = comment[temp_count];
 
     // ç¼–è¾‘æ¡†è·å¾—ç„¦ç‚¹
     editor.focus();
 
     // è·å–é€‰å®šå¯¹è±¡
     var selection = getSelection();
     // å¦‚æœä¿å­˜çš„æœ‰ä¸Šæ¬¡çš„å…‰æ ‡å¯¹è±¡
     if (lastEditRange) {
         // æ¸…é™¤æ‰€æœ‰é€‰åŒº
         selection.removeAllRanges();
         // æ·»åŠ æœ€åå…‰æ ‡è¿˜åŸä¹‹å‰çš„çŠ¶æ€
         selection.addRange(lastEditRange);
     }
     // å¦‚æœé€‰å®šå¯¹è±¡èŒƒå›´æ˜¯ç¼–è¾‘æ¡†èŒƒå›´
     // åˆ›å»ºè¡¨æƒ…æ–‡æœ¬èŠ‚ç‚¹è¿›è¡Œæ’å…¥
     var emojiText = document.createTextNode(editComment);
     // å¦‚æœæ–‡æœ¬æ¡†çš„å­å…ƒç´ å¤§äº0ï¼Œåˆ™è¡¨ç¤ºæœ‰å…¶ä»–å…ƒç´ ï¼Œåˆ™æŒ‰ç…§ä½ç½®æ’å…¥è¡¨æƒ…èŠ‚ç‚¹
     if (editor.childNodes.length > 0) {
         for (var i = 0; i < editor.childNodes.length; i++) {
             if (i == selection.anchorOffset) {
                 editor.insertBefore(emojiText, editor.childNodes[i]);
             }
         }
     } else {
         // å¦åˆ™ç›´æ¥æ’å…¥ä¸€ä¸ªè¡¨æƒ…å…ƒç´ 
         editor.appendChild(emojiText);
     }
     // åˆ›å»ºæ–°çš„å…‰æ ‡å¯¹è±¡
     var range = document.createRange();
     // å°†å…‰æ ‡å¯¹è±¡çš„èŒƒå›´ç•Œå®šä¸ºæ–°å»ºçš„è¡¨æƒ…èŠ‚ç‚¹
     range.selectNodeContents(emojiText);
     // å®šä½å…‰æ ‡ä½ç½®åœ¨è¡¨æƒ…èŠ‚ç‚¹çš„æœ€å¤§é•¿åº¦ä½ç½®
     range.setStart(emojiText, emojiText.length);
 
     // å°†é€‰åŒºæŠ˜å ä¸ºä¸€ä¸ªå…‰æ ‡
     range.collapse(true);
     // æ¸…é™¤æ‰€æœ‰å…‰æ ‡å¯¹è±¡A
     selection.removeAllRanges();
     // æ·»åŠ æ–°çš„å…‰æ ‡å¯¹è±¡
     selection.addRange(range);
     // è®°å½•æœ€åå…‰æ ‡å¯¹è±¡
     lastEditRange = selection.getRangeAt(0);
 }
 editContent();
```

æ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/55d7e8a7d0b8484084538fd262f01644~tplv-k3u1fbpfcp-watermark.image?)

ï¼ˆå›¾ç‰‡è¯´æ˜ï¼šfocus æ–¹æ³•ç¡®å®æˆåŠŸï¼Œç‚¹äº®æ–‡æœ¬æ¡†äº†ï¼Œä½†æ˜¯å†…å®¹çš„æ”¹å˜ï¼Œä»ç„¶æ— æ³•è¢«ç›‘å¬ï¼‰

åŒ…æ‹¬å…‰æ ‡çš„ä½ç½®æ­¤æ—¶ä¹Ÿæ”¹å˜äº†ï¼Œä½†å®ƒä»ç„¶åªç®—æˆ‘ä¿®æ”¹äº†è§†å›¾å†…å®¹ï¼Œå› ä¸ºè¯„è®ºçš„æŒ‰é’®ä»ç„¶æ˜¯æš—çš„ã€‚

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘çªç„¶æƒ³åˆ°ï¼Œæˆ‘æ‰‹åŠ¨ç»™å®ƒèµ‹å€¼ä¸è¡Œï¼Œæˆ‘å¯ä»¥æ“çºµå¤åˆ¶ç²˜è´´æ–¹æ³•å•Šã€‚

ç„¶åè¿™ä¸ªæ—¶å€™åˆå¼€å§‹è¸©å‘äº†ï¼ï¼ï¼

### 3.3ã€å°è¯•ä½¿ç”¨copyã€paste æ–¹æ³•

æˆ‘åªæ˜¯éšçº¦çŸ¥é“æµè§ˆå™¨å¯ä»¥æ“ä½œ copyã€paste æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰å°è¯•è¿‡ã€‚

åˆç»§ç»­å¼€å§‹ç–¯ç‹‚çš„æœç´¢~

è¿™æ¬¡å°è¯•ä¹‹å‰ï¼Œæˆ‘å…ˆäº†è¯•ï¼Œç¡®å®šåœ¨è·å–åˆ°divå†…å®¹æ¡†çš„ç„¦ç‚¹åï¼Œcvæ˜¯å¯ä»¥çš„ä¹‹åï¼Œæˆ‘å°±æƒ³åœ¨ç²˜è´´æ¿ä¸Šåšç‚¹æ–‡ç« 

æˆ‘çš„æ€è·¯æ˜¯ï¼Œå…ˆæŠŠè¯„è®ºå†…å®¹åˆ¶é€ å¥½ï¼Œç„¶åç”¨Jså¤åˆ¶åˆ°ç²˜è´´ç‰ˆä¸Šï¼Œä¹‹åå†è°ƒç”¨ paste æ–¹æ³•å°†å†…å®¹ç²˜è´´åˆ° div çš„é‚£ä¸ªå†…å®¹æ¡†ä¸­å»ã€‚

æƒ³æ³•è¿˜æ˜¯æŒºç¾å¥½çš„ã€‚

å‚è€ƒç€ä¸‹é¢çš„å†…å®¹è¿›è¡Œç€å°è¯•

-   [é˜®ä¸€å³°çš„ç½‘ç»œæ‚å¿—](http://www.ruanyifeng.com/blog/2021/01/clipboard-api.html)
-   [JavaScript å¤åˆ¶ç²˜è´´æŠ€å·§ï¼](https://juejin.cn/post/7036000574747181092#heading-14)

å°è¯•äº†ä¸‹é¢çš„å†…å®¹

1.  `Document.execCommand()`æ–¹æ³•
1.  å¼‚æ­¥çš„ Clipboard API
1.  `copy`äº‹ä»¶å’Œ`paste`äº‹ä»¶

#### 3.3.1ã€Document.execCommand()

æœ€å…ˆå°è¯•çš„ `Document.execCommand()` äº‹ä»¶ï¼ŒChromeã€Firefox ä¸æ”¯æŒ

```
 document.execCommand('paste')
```


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8be67623b73448618f0effefa47307aa~tplv-k3u1fbpfcp-watermark.image?)

å¯¼è‡´è¿™ä¸€æ­¥ç›´æ¥GG äº†~

#### 3.3.2ã€Clipboard API

ç„¶å `Clipboard API` æ˜¯åå‘äºæ“ä½œå‰ªè´´æ¿ï¼Œå°±æ˜¯å¯ä»¥å†™å…¥ï¼Œè¯»å‡ºï¼Œä½†æ˜¯å¹¶ä¸æ˜¯è§¦å‘ pasteæ–¹æ³•ï¼Œ

æˆ‘ä¹Ÿæ‰¾äº†ä¸€ä¸ªå°æ¡ˆä¾‹ï¼š

```
  <body>
     <p>hello world</p>
     <button id="btn-copy">copy text</button>
     <button id="btn-paste">copy text</button>
     <script>
       const copyBtn = document.querySelector('#btn-copy');
       
       copyBtn.addEventListener(
         'click',
         async function () {
           try {
             // å°† p æ ‡ç­¾å†…çš„æ–‡æœ¬ç¼–è¾‘åå†™å…¥å‰ªåˆ‡æ¿
             await navigator.clipboard.writeText(
               `${document.querySelector('p').textContent}!`
             );
           } catch (e) {
             console.error('Failed to copy: ', e);
           }
         },
         false
       );
     
       const pasteBtn = document.querySelector('#btn-paste');
 
       pasteBtn.addEventListener(
         'click',
         async function () {
           try {
             // è¯»å–å‰ªåˆ‡æ¿ä¸­çš„æ–‡æœ¬
             const text = await navigator.clipboard.readText();
             console.log(text);
           } catch (e) {
             console.error('Failed to read clipboard content: ', e);
           }
         },
         false
       );
     </script>
   </body>
```

è¿™ä¸€æ­¥ä¹Ÿå°±è®©æˆ‘èººäº†ï¼Œåˆå»å°è¯•ä¸‹ä¸€ä¸ªæ–¹æ³•ï¼š

å¦å¤–è¿˜å‚è€ƒäº† MDN æ–‡æ¡£ï¼š[Element: paste event](https://developer.mozilla.org/en-US/docs/Web/API/Element/paste_event)

#### 3.3.3ã€clipboard.js

æˆ‘ä¹Ÿå°è¯•äº†è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯æˆ‘å‘ç°ï¼Œå®ƒåªèƒ½ç›‘å¬ç”¨æˆ·çš„ paste äº‹ä»¶ï¼Œå½“æ—¶ç²˜è´´äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæ‰èƒ½å¤„ç†äº‹ä»¶~

```
 <!DOCTYPE html>
 <html lang="en">
   <head>
     <meta charset="UTF-8" />
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     <title>Document</title>
     <script
       type="text/javascript"
       src="https://cdn.bootcss.com/clipboard.js/2.0.1/clipboard.js"
     ></script>
   </head>
   <body>
     <!-- Target -->
     <input id="input" value="ä½ å¥½ï¼Œæˆ‘æ˜¯å®åœ¨æ˜¥" />
     <!-- Trigger -->
     <button class="copy">Copy to clipboard</button>
     <button id="paste">paste</button>
     <textarea id="output"> </textarea>
     <script>
       var clipboard = new ClipboardJS(".copy", {
         text: function (trigger) {
           return doCopy();
         },
       });
       var pastBtn = document.getElementById("output");
 
       pastBtn.addEventListener("paste", function (event) {
         console.log(pastBtn);
         if (event.clipboardData || event.originalEvent) {
           var clipboardData = event.clipboardData || window.clipboardData;
           var val = clipboardData.getData("text");
           if (val) {
             doPast(val);
           } else {
             throw new Error("å‰ªåˆ‡æ¿å†…å®¹ä¸ºç©ºæˆ–è€…éæ–‡æœ¬ç±»å‹");
           }
           event.preventDefault();
         }
       });
       //è·å–è¦å¤åˆ¶åˆ°å‰ªåˆ‡æ¿çš„å†…å®¹
       function doCopy() {
         return document.getElementById("input").value;
       }
 
       //å¤„ç†å‰ªåˆ‡æ¿å†…å®¹
       function doPast(value) {
         alert(value);
       }
     </script>
   </body>
 </html>
 
```

`è¡¥å……`:åœ¨è¿™ä¸€æ­¥çš„æ—¶å€™ï¼Œæˆ‘åŸæœ¬è¿˜æƒ³ç»§ç»­å»å°è¯•ç”¨JavaScript æ¨¡æ‹Ÿé”®ç›˜æŒ‰é”®å»å°è¯•è§¦å‘å¤åˆ¶ç²˜è´´äº‹ä»¶çš„ï¼Œä½†æ˜¯æ²¡æœ‰å»å°è¯•å•¦ï¼Œä¸»è¦åœ¨ç½‘ä¸Šæœåˆ°çš„çŸ¥è¯†ï¼Œä¸æ•¢è¯´åƒç¯‡ä¸€å¾‹ï¼Œä½†æ˜¯ç‚¹å¼€å¤§éƒ½æ•°æ–‡ç« ç•¥å¾®æœ‰ç‚¹è®©äººå¤±æœ›~ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯è½¬è½½æ¥è½¬è½½å»ï¼ˆä¸ªäººåæ§½ï¼Œè½»å–·ï¼‰ï¼Œä¸€ç¯‡æ–‡ç« èƒ½çœ‹è§å¥½å‡ æ¬¡ï¼Œå“ˆå“ˆ

***

åæ¥æƒ³èµ·ç¬¬ä¸€ç¯‡çœ‹åˆ°çš„æ–‡ç« ï¼ŒèŠåˆ°çš„æ˜é‡‘çš„è¡¨æƒ…ï¼Œç„¶åå°±æœ‰äº†ä¸‹é¢çš„çµå…‰ä¸€ç°~

### 3.4ã€çµå…‰ä¸€ç°

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘æƒ³ç€ï¼Œæ‰‹åŠ¨æ”¹ä½ å†…å®¹ä¸è¡Œï¼Œç›´æ¥ç‚¹å‡»è¡¨æƒ…ï¼Œç„¶åæ”¾åˆ°divä¸­ï¼Œè¿™æ ·æ€»å¯ä»¥å§

***

å› ä¸ºåªè¦æ‰“å¼€emjoe é¢æ¿ï¼Œç‚¹ä¸€ä¸‹è¡¨æƒ…ï¼Œå°±ä¼šè‡ªåŠ¨çš„æ·»åŠ åˆ°é‚£ä¸ªå†…å®¹æ¡†ä¸­å»ï¼Œè¿™ä¸€æ¬¡å°è¯•ç«Ÿç„¶æ˜¯okçš„~

```
      // è·å–è¯„è®ºåŒºç„¦ç‚¹
       function getFocus() {
         document.getElementsByClassName("rich-input")[0].focus();
       }
       //æ‰“å¼€emoje è¡¨æƒ…é€‰æ‹©æ¡†
       function getEmojeClick() {
         document.getElementsByClassName("emoji-box")[0].click();
       }
       //é€‰æ‹©emojeè¡¨æƒ…
       function getChoseEmoje() {
         var emojipicker = document.getElementsByClassName("emojipicker")[0];
         var emojeImage = emojipicker.getElementsByClassName("list")[1];
         var item = emojeImage.getElementsByClassName("item")[0];
         var spanImage = item.getElementsByClassName("byte-tooltip__wrapper")[0];
         var img = spanImage.querySelector("img");
         img.click();
       }
       getFocus();
       getEmojeClick();
       getChoseEmoje();
```

å¤§å®¶å¯ä»¥ç›´æ¥æŠŠè¿™ä¸€æ­¥æ”¾åˆ°æ˜é‡‘çš„æ–‡ç« é¡µé¢ï¼ŒF12åï¼Œå°†ä»£ç å¤åˆ¶è¿è¡Œï¼Œæ˜¯å¯è¡Œçš„~

åœ¨è¿™ä¸€æ­¥å¯è¡Œä¹‹åï¼Œæˆ‘åˆæƒ³åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¢å¼ºï¼Œæ—¢ç„¶é€‰æ‹©æ˜é‡‘çš„è¡¨æƒ…æ˜¯å¯ä»¥çš„ï¼Œé‚£æˆ‘å…ˆåŠ ä¸€ä¸ªè¡¨æƒ…ï¼Œç„¶åå†åŠ ä¸Šæˆ‘è‡ªå·±çš„è¯„è®ºå†…å®¹ï¼Œä¸å°±è¡Œäº†å—~ï¼Œè¯´åšå°±åš

ä»£ç ä¸è´´äº†ï¼Œç›´æ¥è¯´ç»“æœï¼Œå¤±è´¥äº†~ï¼Œè¿˜æ˜¯å’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·ï¼Œå‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œæ ¹æœ¬æ²¡æœ‰æºå¸¦è¿™ä¸ªæ•°æ®å†…å®¹

## åè®°

> æœ€åå®ç°æ•ˆæœå¤§å®¶ä¹Ÿçœ‹åˆ°äº†ï¼Œå› ä¸ºæš‚æ—¶æ²¡æœ‰æ‰¾åˆ°æ›´å¥½çš„ä¸€ä¸ªæ–¹æ³•å»å®ç°ï¼Œæˆ‘æœ€åç”¨è¡¨æƒ…å¦¥åäº†ï¼Œè¡¨æƒ…é€‰ç”¨äº†å‡ ä¸ªæ¯”è¾ƒæ­£å‘çš„è¡¨æƒ…ï¼Œç„¶ååœ¨è¯„è®ºçš„æ—¶å€™è¿›è¡Œéšæœºé€‰æ‹©

ä»£ç æ¯”è¾ƒåå‘äºåŸºç¡€ï¼Œä½¿ç”¨åˆ°çš„å…¨éƒ¨éƒ½æ˜¯ JavaScript ä¸­çš„åŸºç¡€çŸ¥è¯†ï¼Œå†™å‡ºæ¥ä¹Ÿæ˜¯æˆ‘çš„ä¸€ä¸ªå°è¯•ï¼Œå¤§å®¶å–œæ¬¢ä¸å¦ï¼Œæˆ‘å¹¶ä¸èƒ½çŸ¥æ™“ã€‚

å…³äºè¿™ç¯‡æ–‡ç« ï¼Œå¦‚æœæ˜¯å¯¹äºä»æ¥æ²¡æœ‰æ¥è§¦è¿‡æ²¹çŒ´è„šæœ¬çš„å°ä¼™ä¼´æ¥è¯´ï¼Œæ‹¿æ¥çœ‹ä¸€çœ‹è¿™ä¹ˆç®€å•ï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªæ¥è§¦ã€‚

é™¤äº†è¿™ä¸€ç‚¹å¤–ï¼Œæˆ‘ä¹Ÿä¸æ•¢è¯´æ­¤æ–‡ï¼Œå¯¹è¯»è€…è€Œè¨€ï¼Œèƒ½æœ‰å¤šå°‘æ”¶è·äº†ã€‚

> å¦‚æœæ„Ÿå…´è¶£å¯ä»¥å¤šåšå°è¯•ï¼Œåœ¨è¿™å…¶ä¸­ï¼Œå¤šå°‘ä¼šæœ‰ä¸€äº›æ”¶è·ã€‚
>
> å¯¹äº†ï¼Œä¸è¦è¢«é™Œç”Ÿçš„äº‹ç‰©å“ä½äº†ï¼Œåªè¦è¿ˆå‡ºç¬¬ä¸€æ­¥ï¼Œé‚£ä¹ˆå°±æ˜¯æˆåŠŸçš„ğŸ˜€
>
> **æˆ‘æ˜ç™½æˆ‘å¯¹äºå‰ç«¯é¢†åŸŸï¼Œå°±æ˜¯ä¸€ä½å°ç™½ï¼Œæ–‡ä¸­ä¸å¯é¿å…å¯èƒ½ä¼šå‡ºç°é”™è¯¯æˆ–é—æ¼ï¼Œè¯·å¤§å®¶ä¸€å®šè¦è¿›è¡ŒæŒ‡å‡ºï¼**
>
> å½“ç„¶å¦‚æœè®©ä½ æœ‰æ‰€æ”¶è·çš„è¯ï¼Œä¹Ÿå¸Œæœ›å¯ä»¥ç•™ä¸‹ä½ çš„èµ~ï¼Œå“ˆå“ˆ

å¤§ä¼™å¯ä»¥ç›´æ¥å°†ä»£ç æ”¾è¿›æ²¹çŒ´ï¼Œæ¥è¯•ä¸€è¯•è¿™ä¸ªè„šæœ¬çš„æ•ˆæœï¼Œ**å¯ä»¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œè®©æˆ‘çœ‹åˆ°ä½ ä»¬çš„å®æ“å—**~

ä¹Ÿå¯ä»¥æŠŠç¬¬ä¸€ä¸ªä¸­ function ä¸­çš„æ‰€æœ‰ä»£ç ç›´æ¥æ”¾åˆ°ç½‘é¡µä¸­æ‰§è¡Œï¼Œä¹Ÿæ˜¯å¯ä»¥çš„~


å†™äº 2022 å¹´ 8 æœˆ 7 æ—¥æ™šï¼Œä½œè€…ï¼š[å®åœ¨æ˜¥](https://juejin.cn/user/2859142558267559)
